---
title: 计算机组成原理（一）
seo_title: seo名称
toc: true
indent: true
top: false
comments: true
archive: true
cover: false
mathjax: false
pin: false
top_meta: false
bottom_meta: false
sidebar:
  - toc
tag:
  - 计算机组成原理
  - 《计算机组成原理》
categories: 计算机基础
keywords: 文章关键词
updated: ''
img: /medias/featureimages/39.webp
date:
summary: 计算机基本组成、总线
---
# 计算机组成原理（上）
## 计算机组成原理启蒙
### 1.计算机基本组成
#### 1.1冯诺依曼结构
**①特点**
>计算机由**运算器**、**控制器**、**存储器**、**输入设备**、**输出设备**五大部分组成

>**指令**和**数据**以**同等地位**存储，用**二进制**表示，其中**指令**由**操作码**和**地址码**组成
{%right%}
程序是指令的集合，也存储在存储器中
{%endright%}
>以**运算器**为中心
{%list%}
以运算器为中心导致运算器成为瓶颈，故再次基础上对其进行改进，以存储器为核心
{%endlist%}
**②以存储器为核心**
![以存储器为核心的冯诺依曼结构](/image/JZ_1.png)

#### 1.2主要部件
**①存储器**
>**存储体**：由多个**存储单元**构成，存放**二进制代码**

>**MAR**：存储器**地址寄存器**，反映存储**单元个数**

>**MDR**：存储器**数据寄存器**，反映存储器**字长**
{%right%}
MAR相当于存储器的地址线，MDR相当于存储器的数据线
{%endright%}

**②运算器**
>**ALU**：**算数逻辑单元**，进行**主要运算**的单元

>**相关寄存器**：`ACC`、`MQ`、`X`寄存器，不同的**指令**，这些寄存器的**用途不同**
{%right%}
使用运算器前，需要将各个数据放入对应的寄存器中，运算完成后，结果也存放在对应寄存器中
{%endright%}
{%warning%}
不同的CPU运算器都是不同的，尤其是寄存器的个数及其用途
{%endwarning%}

**③控制器**
{%list%}
解释指令，并保证指令的按序执行
{%endlist%}
>**PC**：存放当前**欲执行指令的地址**，即**取指**

>**IR**：存放当前**欲执行的指令**，即**分析指令**

>**CU**：取得指令的**操作码**和**地址码**，并发出**控制信号**以**执行指令**

![结构](/image/JZ_2.png)

#### 1.3一条指令的完成过程
{%list%}
以取数指令为例
{%endlist%}
>**PC**将**指令地址**送入**MAR**

>**MAR**从存储体中**取出取数指令**放入**MDR**

>**MDR**将**指令**送入**IR**

>**IR**将指令的**操作码**送入**CU**，**地址码**送入**MAR**

>在**CU**的控制下，从**存储体**中取出**对应数据**放入**MDR**，随后送入**ACC**

>**PC+1**等待**下一条指令**


#### 1.4机器主要指标
>**机器字长**：CPU**一次**能处理**数据的位数**
{%list%}
通常情况，机器字长和寄存器长度是相同的
{%endlist%}
>**运算速度**：**主频**、**核数**、**CPI**和**MIPS**等
{%list%}
CPI为执行一条指令所需的时钟周期数，MIPS为每秒能执行多少条指令
{%endlist%}
>**存储容量**：可以表示为**字节数**或者**存储单元个数x存储字长**
****
### 2.系统总线
#### 2.1引言
**①定义**
>连接**各个部件**的**信息传输线**，是各个部件**共享的传输介质**
{%warning%}
一根总线在同一时间只能被一组设备使用
{%endwarning%}

**②总线的分类**
>**片内总线**：**芯片内部**的总线

>**系统总线**：**计算机各部件之间**的总线
{%list%}
还可细分位数据总线、地址总线和控制总线
{%endlist%}

>**通信总线**：**计算机系统之间**或者计算机系统**与其他系统**的通信
{%list%}
通信总线还可细分位串行通信总线和并行通信总线
{%endlist%}

**③总线性能指标**
{%list%}
总线标准：一种对总线各种性能指标的规定，如USB和PCI等
{%endlist%}
>**总线宽度**：数据线的**根数**

>**标准传输率**：**每秒**传输的**最大字节数**

>**时钟同步/异步**：是否有**同步时钟**

>**总线复用**：**地址线**与**数据线**是否复用，总线复用能**有效减少芯片的管脚数**

>**信号线数**、**总线控制方式**等

#### 2.2总线结构
{%warning%}
单总线、双总线结构存在总线争用严重、无法进行设备分级等问题，故不作主要介绍
{%endwarning%}
**①三总线结构**
>**DMA总线**连接**高速设备**，**系统总线**连接**低速设备**
{%warning%}
无法平衡主存和CPU的处理速度差异
{%endwarning%}
![四总线结构](/image/JZ_3.png)
**②四总线结构**
>**高速总线**连接**高速设备**，**扩展总线**连接**低速设备**
{%right%}
cache用于平衡主存和CPU的处理速度差异
{%endright%}
![四总线结构](/image/JZ_5.png)

**③PCI总线结构**
>其中**设备能接的地方**也能接`PCI桥`，从而实现**设备分级**，经过**越多的桥**，**速度越慢**

![PCI总线结构](/image/JZ_6.png)

#### 2.3总线占用控制
**①设备分类**
>**主设备**：可以主**动申请总线资源**并对总线进行**控制权**

>**从设备**：只能**响应主设备**发来的**总线命令**，不能**主动**申请**总线资源**

**②链式查询方式**
>**BR线**：设备通过这条线发出**总线占用请求**

>**BS线**：如果**总线被占用**，则会**收到对应信号**

>**BG线**：总线**授权**线，按照**设备的优先级**依次连接
{%list%}
总线空闲时，多个设备提出总线占用请求，通过BG线依次查询部件，先给优先级高的部件提供总线，并设置总线忙
{%endlist%}
{%warning%}
对电路故障敏感，且靠后的设备很难申请到总线，速度较慢，通常用于简单的系统中
{%endwarning%}

![链式查询方式](/image/JZ_7.png)

**②计数器定时查询**
>**总线控制部件**中有一个**计数器**，为某个数`n`（可以**人为**或者**通过程序控制**），当接收到**总线请求**后，**根据计数器的值`n`**，通过**设备地址线**从**第n个部件开始**查找，直到**找到发出总线请求**的部件
{%list%}
和链式类似，但是链式的值只能是0，定时器可以设置优先级
{%endlist%}
![计数器定时查询](/image/JZ_8.png)

**③独立请求方式**
>**每个部件**都有对应的**BR线**和**BS线**，**总线控制部件**中有一个**排队器**设置**设备的优先级**

![独立请求方式](/image/JZ_9.png)

#### 2.4总线通信控制
**①总线传输周期**
>**申请分配阶段**：主模块**申请总线**

>**寻址阶段**：**主模块**给出**地址**和**命令**，通过地址**找到从设备**并**传递命令**

>**传数阶段**：主从模块**交换数据**

>**结束阶段**：主从模块**撤销相关信息**

**②同步通信**
>**统一时标**控制**通信过程**，需要在**对应的传输周期节点**必须完成**对应的操作**
{%warning%}
对于速度不一样的模块，选择速度最慢的模块对时标进行设计，即速度快的模块需要等速度慢的模块
{%endwarning%}
**③异步通信**
>**不互锁**：主设备**发出请求**，**一定时间后**撤销，从设备**接收到请求后应答**，**一段时间后**撤销

>**半互锁**：主设备**发出请求**后，只有**接收到应答信号**才撤销请求信号，从设备**接收到请求后应答**，**一段时间后**撤销

>**全互锁**：主设备**发出请求**后，只有**接收到应答信号**才撤销请求信号，从设备**接收到请求后应答**，只有**知道主设备撤销请求后**再撤销应答信号

**④半同步通信**
>类似于**同步通信**，但是如果**某个时间点**主/从设备**没有准备好**，则会插入**一个个等待周期**，直到其**准备好继续**

**⑤分离式通信**
{%list%}
一个总线传输周期会有不使用总线的小周期，比如从设备准备数据
{%endlist%}
{%right%}
为了提高总线使用效率，将总线周期分为两个子周期，在不使用总线时先释放总线，随后需要使用再申请
{%endright%}
>**第一个子周期**：**主模块申请占用总线**，使用完后**放弃总线的使用权**

>**第二个子周期**：当主/从模块**准备好数据**，**从模块在申请占用总线**，将各种信息送至总线上
***

### 3.存储器
#### 3.1分类
**①按照存储介质分类**
>**半导体存储器**：易失

>**磁表面存储器**：非易失

>**磁芯存储器**：非易失

>**光盘存储器**：非易失

**②按存取方式分类**
>**存取时间与物理地址无关**：**随机存储器**

>**存取时间与物理地址有关**：**顺序存取存储器**（磁带）、**直接存取存储器**（磁盘）

#### 3.2层次结构
![层次结构](/image/JZ_10.png)
![层次结构](/image/JZ_11.png)
{%list%}
主存和辅存层次解决容量问题，若程序过大，则会将一部分放入主存，其余部分放入辅存
{%endlist%}
{%list%}
缓存和主存层次解决CPU和主存速度差异问题，缓存中存放CPU经常使用的的主存信息
{%endlist%}


#### 3.3主存
**①基本构成**
![主存基本构成](/image/JZ_12.png)

{%list%}
不同存储器的存储单元存储方式可能不同
{%endlist%}
>**大端大尾**：**高位字节地址**为字地址，**高位字节**存储**字的低位**

>**小端小尾**：**低位字节地址**为字地址。**低位字节**存储**字的低位**


**②主要技术指标**
>**存储容量**：存放**二进制代码**的**总位数**

>**存取时间**：存储器的**访问时间**

>**存储周期**：**连续两次独立**的存储器操作所需的**最小间隔时间**

>**存储器带宽**：**单位时间存储读取的长度（位/秒）**


#### 各种介质
半导体存储芯片
![组成](/image/JZ_21.png)
片选线表示哪片芯片被访问

![片选法](/image/JZ_22.png)
地址译码器，四位，表示有16个单元
读写控制电路，8位，表示每个单元为8位

![重合法](/image/JZ_23.png)
每次只选择一个位输出到I/O接口中

随机存取存储器
静态RAM
![静态RAM基本电路](/image/JZ_24.png)
利用行列开关选择存储单元，触发器控制存储01，通过写/读放大器与读写信号控制读写
将每一行分为四组，每一组位16列，其中列地址只有16位，给出一个列地址，每一组对应列地址的单元会被选中，这样就可以同时选中四个单元
![RAM矩阵读写](/image/JZ_25.png)

动态RAM
以三管为例
0/1内容保存在C_g中，如果读选择线有效，则T_2导通，如果写选择线有效，则T_3导通，
若预充电信号有效，则T_4导通，V_DD对读数据线充电，都数据线变为1，读选择线有效，T_2导通，若C_g保存信号是0（低电平），T_1不会导通，数据线不会放电，读数据线保持为1，反之T_1导通，读数据线放电，变为0
![动态RAM](/image/JZ_26.png)
读出信息与原存信息相反
写入信息与输入信息相同
每个行地址都有读选择线和写选择线，然后通过列地址精确定位
![动态RAM芯片](/image/JZ_27.png)
电容中信息容易丢失（容易漏电），刷新至于行地址有关（每次刷新一行的数据）
集中刷新：每隔一段时间对所有的行进行刷新，在此期间，动态RAM无法使用（死区）
![集中刷新](/image/JZ_28.png)
分散刷新：每隔一段时间对某一行进行刷新，但是这样导致存取周期变长，因为刷新时间也算入到存取周期中了
![分散刷新](/image/JZ_29.png)
异步刷新：每个一段时间刷新几行，只要将刷新时间安排在指令译码阶段，可以大大减小死区
![分散刷新](/image/JZ_30.png)
动态RAM集成度较高，功耗小，价格低，速度慢，一般用于主存，静态RAM集成度较低，功耗大，一般用于做缓存

ROM只读存储器，用于保存系统程序和系统信息
MROM：只能读，不能进行擦写
PROM：只能进行一次擦写
EPROM：能进行多次擦写，紫外线
EEPROM：能进行多次擦写，电
闪存：能多次擦写，速度快，且类似于RAM

CPU和存储器的连接
位扩展：将多个芯片连接成一个芯片，其中片选线和控制线需要共用
![分散刷新](/image/JZ_31.png)
字扩展：增加地址线，作为片选线，将两个芯片的地址空间分开
![分散刷新](/image/JZ_32.png)
同时扩展
![分散刷新](/image/JZ_33.png)
CPU和存储器的连接
>上面地址范围存储系统，下面存储用户程序，MREQ表示访问的是I/O端口
![分散刷新](/image/JZ_34.png)
![分散刷新](/image/JZ_35.png)

存储器的校验
电子元件可能发生故障，0/1错误
![分散刷新](/image/JZ_36.png)


微指令系统